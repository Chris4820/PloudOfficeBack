{"version":3,"file":"permission.middleware.js","sourceRoot":"/","sources":["middleware/permission.middleware.ts"],"names":[],"mappings":";;AAQA,0CAaC;AApBD,uFAAqF;AACrF,iEAAuE;AAMhE,KAAK,UAAU,eAAe,CAAC,GAAY,EAAE,GAAa,EAAE,IAAkB;IACnF,IAAI,CAAC;QACH,MAAM,IAAI,GAAG,MAAM,IAAA,4CAAqB,EAAC,GAAG,CAAC,MAAM,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC;QAClE,IAAG,CAAC,IAAI,EAAE,CAAC;YACT,MAAM,IAAI,oCAAqB,CAAC,mCAAmC,CAAC,CAAC;QACvE,CAAC;QACD,IAAG,IAAI,CAAC,IAAI,KAAK,OAAO,IAAI,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,CAAC;YAClD,MAAM,IAAI,oCAAqB,CAAC,gDAAgD,CAAC,CAAC;QACpF,CAAC;QACD,IAAI,EAAE,CAAA;IACR,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,IAAI,CAAC,KAAK,CAAC,CAAC;IACd,CAAC;AACH,CAAC","sourcesContent":["import type { NextFunction, Request } from \"express\";\r\nimport { CheckRoleCollaborator } from \"../modules/collaborator/collaborator.service\";\r\nimport { UnauthorizedException } from \"../commons/errors/custom.error\";\r\n\r\n\r\n\r\n\r\n\r\nexport async function VerifyIfIsAdmin(req: Request, res: Response, next: NextFunction) {\r\n  try {\r\n    const user = await CheckRoleCollaborator(req.userId, req.storeId);\r\n    if(!user) {\r\n      throw new UnauthorizedException(\"Você não é colaborador desta loja\");\r\n    }\r\n    if(user.role !== \"OWNER\" || user.role !== \"OWNER\") {\r\n      throw new UnauthorizedException(\"Você não tem permissão para executar esta ação\");\r\n    }\r\n    next()\r\n  } catch (error) {\r\n    next(error);\r\n  }\r\n}"]}