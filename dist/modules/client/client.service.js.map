{"version":3,"file":"client.service.js","sourceRoot":"/","sources":["modules/client/client.service.ts"],"names":[],"mappings":";;;;;AAKA,8CAmBC;AAED,oCA4BC;AAtDD,+DAAuC;AAKhC,KAAK,UAAU,iBAAiB,CAAC,OAAe,EAAE,IAAa;IACpE,OAAO,MAAM,gBAAM,CAAC,MAAM,CAAC,QAAQ,CAAC;QAClC,KAAK,EAAE;YACL,MAAM,EAAE,OAAO;YACf,GAAG,CAAC,IAAI,IAAI;gBACV,IAAI,EAAE;oBACJ,QAAQ,EAAE,IAAI;oBACd,IAAI,EAAE,aAAa;iBACpB;aACF,CAAC;SACH;QACD,MAAM,EAAE;YACN,EAAE,EAAE,IAAI;YACR,IAAI,EAAE,IAAI;YACV,KAAK,EAAE,IAAI;YACX,KAAK,EAAE,IAAI;SACZ;QACD,IAAI,EAAE,CAAC;KACR,CAAC,CAAC;AACL,CAAC;AAEM,KAAK,UAAU,YAAY,CAAC,MAAc,EAAE,IAAY,EAAE,KAAa,EAAE,KAAa,EAAE,KAAa;IAC1G,OAAO,MAAM,gBAAM,CAAC,MAAM,CAAC,MAAM,CAAC;QAChC,KAAK,EAAE;YACL,MAAM;YACN,KAAK;SACN;QACD,MAAM,EAAE;YACN,KAAK;YACL,IAAI;YACJ,SAAS,EAAE,IAAI,IAAI,EAAE;YACrB,KAAK;YACL,KAAK;YACL,MAAM;SACP;QACD,MAAM,EAAE;YACN,KAAK;YACL,IAAI;YACJ,SAAS,EAAE,IAAI,IAAI,EAAE;YACrB,KAAK;YACL,KAAK;YACL,MAAM;SACP;QACD,MAAM,EAAE;YACN,EAAE,EAAE,IAAI;YACR,IAAI,EAAE,IAAI;YACV,KAAK,EAAE,IAAI;SACZ;KACF,CAAC,CAAA;AACJ,CAAC","sourcesContent":["import prisma from \"../../libs/prisma\";\r\n\r\n\r\n\r\n\r\nexport async function findClientByEmail(storeId: number, name?: string) {\r\n  return await prisma.client.findMany({\r\n    where: {\r\n      shopId: storeId,\r\n      ...(name && {\r\n        name: {\r\n          contains: name,\r\n          mode: 'insensitive',\r\n        },\r\n      }),\r\n    },\r\n    select: {\r\n      id: true,\r\n      name: true,\r\n      email: true,\r\n      notes: true,\r\n    },\r\n    take: 5,\r\n  });\r\n}\r\n\r\nexport async function upsertClient(shopId: number, name: string, email: string, notes: string, phone: string) {\r\n  return await prisma.client.upsert({\r\n    where: {\r\n      shopId,\r\n      email,\r\n    },\r\n    create: {\r\n      email,\r\n      name,\r\n      updatedAt: new Date(),\r\n      notes,\r\n      phone,\r\n      shopId,\r\n    },\r\n    update: {\r\n      email,\r\n      name,\r\n      updatedAt: new Date(),\r\n      notes,\r\n      phone,\r\n      shopId,\r\n    },\r\n    select: {\r\n      id: true,\r\n      name: true,\r\n      email: true,\r\n    }\r\n  })\r\n}\r\n"]}